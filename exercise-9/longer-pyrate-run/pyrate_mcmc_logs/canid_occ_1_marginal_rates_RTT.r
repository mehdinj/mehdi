# 1 files combined:
# 	/home/eeb177-student/Desktop/eeb-177/mehdi-lab/exercise-9/longer-pyrate-run/pyrate_mcmc_logs/canid_occ_1_marginal_rates.log

# 95% HPDs calculated using code from Biopy (https://www.cs.auckland.ac.nz/~yhel002/biopy/)

pdf(file='/home/eeb177-student/Desktop/eeb-177/mehdi-lab/exercise-9/longer-pyrate-run/pyrate_mcmc_logs/canid_occ_1_marginal_rates_RTT.pdf',width=0.6*9, height=16.8)
par(mfrow=c(4,1))
library(scales)
L_hpd_m95=c(0.155642678257, 0.155642678257,0.155642678257,0.152471288639,0.12141128324,0.0662786361717,0.0346041375178,0.0374810134921,0.0374810134921,0.0378411504484,0.0378411504484,0.0378411504484,0.0379025326675,0.0378411504484,0.0374810134921,0.0371833407344,0.049598231666,0.0558509428731,0.0558509428731,0.0540869937758,0.0612083886851,0.0765814261318,0.0918342601183,0.0987619094848,0.09846957804,0.0983551201712,0.09806597397,0.102264912292,0.0983551201712,0.09806597397,0.114376034278,0.127206974727,0.128321306626,0.134520640139,0.134068695672,0.137710672621,0.137067035146,0.137067035146,0.134068695672,0.131699975525,0.131699975525,0.127144249162,0.127775968642,0.116175232261,0.114544706654,0.12580537824,0.114544706654,0.116175232261)
L_hpd_M95=c(0.359169104062, 0.359169104062,0.359169104062,0.358484895741,0.357566199361,0.340137962652,0.163280346968,0.130349824459,0.128566327339,0.127917691763,0.127917691763,0.127917691763,0.127917691763,0.127917691763,0.128566327339,0.139046740978,0.163511040687,0.169715875318,0.171038733778,0.173528075558,0.197875269547,0.216057867252,0.222654857626,0.223334336388,0.223195907638,0.223195907638,0.223195907638,0.228654168047,0.232561546301,0.251255342423,0.333325054885,0.358643563246,0.366266460455,0.380293940104,0.386315209229,0.392814971652,0.392814971652,0.392814971652,0.392814971652,0.394694151996,0.398683501377,0.394694151996,0.398683501377,0.398545854068,0.400663812646,0.416172784648,0.413818900269,0.416172784648)
M_hpd_m95=c(0.864427161521, 0.864427161521,0.0845518706451,0.0845518706451,0.0847929793369,0.0850379763438,0.0845518706451,0.0851135407377,0.0847929793369,0.0858646376641,0.0851135407377,0.0857468083302,0.0850379763438,0.0850379763438,0.0838617050255,0.0816920933448,0.0816920933448,0.0815749532982,0.0814816013714,0.0795800025556,0.0796976867405,0.0778351715596,0.0764969943413,0.0676646425626,0.0618052175128,0.0568109519781,0.0569381480914,0.0567237714443,0.0546525379658,0.0546046932313,0.0547499040074,0.0541024900811,0.0535184308909,0.0521927333049,0.0500170996673,0.0493531864898,0.0482005198486,0.0425911718518,0.0437551359474,0.0386349308849,0.0375137246888,0.0348708517558,0.0338092424403,0.0300707493291,0.027095378864,0.0312287980441,0.0295025493394,0.0295025493394)
M_hpd_M95=c(1.47693509018, 1.47693509018,0.153916784416,0.153916784416,0.153916784416,0.153916784416,0.149997417858,0.14326952638,0.138770912889,0.138770912889,0.137786646322,0.13820600971,0.136324732237,0.135992761895,0.135374488953,0.133361545971,0.133361545971,0.133890989069,0.133890989069,0.131631995544,0.131631995544,0.131055339286,0.134040430632,0.129816211887,0.126449319333,0.123309517881,0.123309517881,0.122810663995,0.122128354164,0.122810663995,0.123309517881,0.123255781182,0.123309517881,0.122632573188,0.122678516664,0.123255781182,0.123309517881,0.123255781182,0.129279095381,0.12974044007,0.130512387559,0.130512387559,0.130512387559,0.132138847429,0.132138847429,0.136934696538,0.135744647578,0.135744647578)
R_hpd_m95=c(-1.21772700296, -1.21772700296,0.037532603763,0.0350031970819,0.00301197753072,-0.047566105409,-0.131842016289,-0.0873853473947,-0.0873853473947,-0.0823275593739,-0.0809081690492,-0.080376760261,-0.080376760261,-0.0805201786992,-0.0805201786992,-0.0720578130431,-0.0674275344438,-0.0588618321022,-0.0566791105979,-0.0589528183925,-0.0503015474057,-0.0275736760424,-0.0201259943743,-0.00665197664713,-0.0067200311323,-0.00127053333948,-0.00207109625783,-0.00163764727427,-0.00513175568764,-0.00680455734911,0.0107373456081,0.0177173215448,0.0324424112886,0.0327550607545,0.0325678115392,0.0325678115392,0.0325678115392,0.0356110150805,0.0241751217689,0.0229234342821,0.0229234342821,0.0224582135,0.0167074434926,0.0186963519792,0.0150980481299,0.0125947569479,0.0125947569479,0.00932838088019)
R_hpd_M95=c(-0.576177142293, -0.576177142293,0.247930945244,0.247930945244,0.247930945244,0.240450777157,0.0528378314267,0.0312305629205,0.0222712937677,0.0223743054029,0.0222712937677,0.0223743054029,0.0216585884936,0.0211720612793,0.0234292434514,0.0439813706653,0.0594430679765,0.0706250582333,0.0746895137736,0.076541922692,0.0997807852904,0.118786511901,0.122140259154,0.129740557483,0.13092998245,0.139727013356,0.140004635298,0.141821275596,0.145406516713,0.15977638083,0.246990809086,0.268665446512,0.287128947989,0.294132332048,0.296674727698,0.302177772355,0.302662702715,0.308633150056,0.308633150056,0.314837138963,0.318237898792,0.318237898792,0.318237898792,0.332429537842,0.332429537842,0.336244675527,0.343537826485,0.343277968517)
L_mean=c(0.266179399304, 0.266179399304,0.266188513138,0.266514187038,0.258789279915,0.23708752634,0.0837300011744,0.0769442091481,0.0764447585446,0.0763354079661,0.0764035146022,0.076420338501,0.0764133331477,0.0765510248433,0.0770260630417,0.0808638653773,0.0957145729587,0.10630402232,0.108775883298,0.112637641579,0.131020778711,0.152214615024,0.158737760078,0.162893699975,0.163536229242,0.163802656081,0.16384363567,0.164445793807,0.167500567356,0.172544640111,0.201368015102,0.227671191425,0.237167844947,0.248090253182,0.255138521197,0.2564021579,0.256329428386,0.25676339263,0.257188326379,0.257154221363,0.257806461774,0.257032428741,0.257890030899,0.259071419373,0.259937965983,0.261792144397,0.26325552401,0.264224554296)
M_mean=c(1.15964947176, 1.15964947176,0.114277794415,0.114286306001,0.1142626208,0.114135723231,0.1132104456,0.111776107394,0.110749563045,0.110035732713,0.109632853061,0.109532530538,0.109218157108,0.108830145054,0.10797453539,0.107147096945,0.106525885269,0.105555428088,0.105258118457,0.105206107469,0.105183242958,0.104771126491,0.103236715456,0.101240157912,0.0994210112344,0.0975888533457,0.0969516024302,0.0963396700439,0.0950361394185,0.0946685613402,0.0944033197434,0.0940290397918,0.093793043007,0.0937020131681,0.0930679195807,0.0927428085254,0.0925213471312,0.0919221935968,0.0926999599835,0.0934885849871,0.0935819850429,0.0938915392981,0.0939853297746,0.0949443281994,0.0953523224299,0.0955734344237,0.0957735944152,0.0957735944152)
R_mean=c(-0.893470072459, -0.893470072459,0.151910718723,0.152227881036,0.144526659115,0.122951803109,-0.0294804444252,-0.0348318982462,-0.0343048045003,-0.0337003247466,-0.033229338459,-0.033112192037,-0.0328048239605,-0.0322791202106,-0.0309484723479,-0.0262832315678,-0.0108113123107,0.000748594231446,0.00351776484137,0.00743153410952,0.0258375357533,0.047443488533,0.0555010446221,0.061653542063,0.0641152180073,0.0662138027356,0.0668920332398,0.0681061237628,0.0724644279372,0.0778760787709,0.106964695359,0.133642151633,0.14337480194,0.154388240014,0.162070601616,0.163659349375,0.163808081254,0.164841199033,0.164488366395,0.163665636376,0.164224476731,0.163140889443,0.163904701125,0.164127091174,0.164585643553,0.166218709973,0.167481929595,0.168450959881)
trans=0.5
age=(0:(48-1))* -1
plot(age,age,type = 'n', ylim = c(0, 0.457790063113), xlim = c(-50.4,2.4), ylab = 'Speciation rate', xlab = 'Ma',main='canid' )
polygon(c(age, rev(age)), c(L_hpd_M95, rev(L_hpd_m95)), col = alpha("#4c4cec",trans), border = NA)
lines(rev(age), rev(L_mean), col = "#4c4cec", lwd=3)
plot(age,age,type = 'n', ylim = c(0, 1.6246285992), xlim = c(-50.4,2.4), ylab = 'Extinction rate', xlab = 'Ma' )
polygon(c(age, rev(age)), c(M_hpd_M95, rev(M_hpd_m95)), col = alpha("#e34a33",trans), border = NA)
lines(rev(age), rev(M_mean), col = "#e34a33", lwd=3)
plot(age,age,type = 'n', ylim = c(-1.33949970325, 0.377891609133), xlim = c(-50.4,2.4), ylab = 'Net diversification rate', xlab = 'Ma' )
abline(h=0,lty=2,col="darkred")
polygon(c(age, rev(age)), c(R_hpd_M95, rev(R_hpd_m95)), col = alpha("#504A4B",trans), border = NA)
lines(rev(age), rev(R_mean), col = "#504A4B", lwd=3)
plot(age,age,type = 'n', ylim = c(0, max(1/M_mean)), xlim = c(-50.4,2.4), ylab = 'Longevity (Myr)', xlab = 'Ma' )
lines(rev(age), rev(1/M_mean), col = "#504A4B", lwd=3)
n <- dev.off()