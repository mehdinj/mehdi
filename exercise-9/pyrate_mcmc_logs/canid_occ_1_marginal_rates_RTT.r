# 1 files combined:
# 	/home/eeb177-student/Desktop/eeb-177/mehdi-lab/exercise-9/pyrate_mcmc_logs/canid_occ_1_marginal_rates.log

# 95% HPDs calculated using code from Biopy (https://www.cs.auckland.ac.nz/~yhel002/biopy/)

pdf(file='/home/eeb177-student/Desktop/eeb-177/mehdi-lab/exercise-9/pyrate_mcmc_logs/canid_occ_1_marginal_rates_RTT.pdf',width=0.6*9, height=16.8)
par(mfrow=c(4,1))
library(scales)
L_hpd_m95=c(0.127868113665, 0.127868113665,0.126901610723,0.126901610723,0.0932665825617,0.0735291577805,0.0410488926493,0.036936113233,0.0402423765447,0.0402423765447,0.0402423765447,0.0402423765447,0.0410488926493,0.0488649359797,0.0553614147535,0.0539997200383,0.0522971096565,0.0522971096565,0.0522971096565,0.0522971096565,0.0488649359797,0.0755068766602,0.0823886898338,0.0922915318104,0.0935107043757,0.0942305505151,0.0964313144723,0.0946958083719,0.0923819859453,0.11953765934,0.133845788313,0.133845788313,0.135928788957,0.15350940518,0.144373244744,0.144373244744,0.139049322552,0.137555013145,0.148200413164,0.137555013145,0.137555013145,0.137555013145,0.0838502915118,0.0838502915118,0.118167511295,0.0917961416404,0.0737287460386,0.0737287460386,0.0737287460386,0.0737287460386)
L_hpd_M95=c(0.332806492415, 0.332806492415,0.332806492415,0.332806492415,0.332806492415,0.315967119023,0.254946300904,0.17104452063,0.139049322552,0.128973691979,0.127909973071,0.127909973071,0.127909973071,0.132954224755,0.132975109955,0.132975109955,0.132975109955,0.132975109955,0.132975109955,0.139049322552,0.207550380992,0.226420873092,0.229428439513,0.233660788395,0.234756765636,0.234756765636,0.243291248404,0.243291248404,0.252066060345,0.322449164348,0.332222105163,0.332222105163,0.337828667281,0.358225736544,0.36536216388,0.36536216388,0.36536216388,0.375821080734,0.401449221224,0.401449221224,0.401449221224,0.413081131899,0.375821080734,0.375821080734,0.413081131899,0.401449221224,0.401449221224,0.401449221224,0.401449221224,0.401449221224)
M_hpd_m95=c(0.772172668096, 0.772172668096,0.0834359159237,0.0834359159237,0.0834359159237,0.0834359159237,0.0909666304001,0.0909666304001,0.0834359159237,0.0741173234058,0.0741173234058,0.0711317629821,0.0741173234058,0.0741173234058,0.079126717973,0.0741173234058,0.076409307539,0.0741173234058,0.0741173234058,0.0741173234058,0.0741173234058,0.0741173234058,0.0741173234058,0.0741173234058,0.0741173234058,0.0741173234058,0.0741173234058,0.0741173234058,0.0741173234058,0.0741173234058,0.0741173234058,0.0741173234058,0.0741173234058,0.0741173234058,0.0741173234058,0.0741173234058,0.0741173234058,0.0741173234058,0.0741173234058,0.0741173234058,0.0709282510619,0.0642936353132,0.0532281362612,0.0642936353132,0.0642936353132,0.0642936353132,0.0642936353132,0.0642936353132,0.0642936353132,0.0642936353132)
M_hpd_M95=c(1.51295554052, 1.51295554052,0.185568912891,0.185568912891,0.185568912891,0.185568912891,0.190780136771,0.190780136771,0.186007043752,0.156307957977,0.141971188362,0.127744746947,0.121295217749,0.12080729173,0.125432588806,0.119656384157,0.121295217749,0.117425372914,0.117425372914,0.117425372914,0.117425372914,0.117425372914,0.117425372914,0.117425372914,0.117425372914,0.117425372914,0.117425372914,0.117425372914,0.117425372914,0.117425372914,0.117425372914,0.117425372914,0.117425372914,0.117425372914,0.117425372914,0.117425372914,0.117425372914,0.119252008518,0.119252008518,0.119656384157,0.124597568244,0.125432588806,0.125432588806,0.141385018105,0.141385018105,0.141385018105,0.141385018105,0.141385018105,0.141385018105,0.141385018105)
R_hpd_m95=c(-1.29618432061, -1.29618432061,0.00570104233776,0.00570104233776,-0.0398199575056,-0.0912434319086,-0.126023039296,-0.139524046527,-0.139524046527,-0.0982416623924,-0.0762557663118,-0.0684119367231,-0.0664305845829,-0.0664305845829,-0.0462234919427,-0.0515406409064,-0.0515406409064,-0.0462234919427,-0.0462234919427,-0.0462234919427,-0.044810943925,-0.0305733812998,-0.0182352820755,-0.0143008637964,-0.00439652886337,-0.00439652886337,-0.00279855279668,-0.00279855279668,-0.00979360639521,-0.00279855279668,0.0359356194889,0.0399210243234,0.0410931535232,0.0399210243234,0.0410931535232,0.0410931535232,0.0362600073595,0.0410931535232,0.0452754840715,-0.00279855279668,-0.00279855279668,-0.00279855279668,-0.0157968013378,-0.00279855279668,-0.00279855279668,-0.0157968013378,-0.0224163120744,-0.0224163120744,-0.0224163120744,-0.0224163120744)
R_hpd_M95=c(-0.532476066591, -0.532476066591,0.23859816265,0.23859816265,0.234846488787,0.204066284272,0.13765972774,0.0606164155916,0.0259548951653,0.0427149918028,0.0427149918028,0.0396137381322,0.024568484711,0.024568484711,0.0445210723658,0.0445210723658,0.0477928997647,0.0452754840715,0.0452754840715,0.0569088986708,0.115764312129,0.128021733905,0.137600889014,0.137600889014,0.148789037995,0.144810885319,0.149891493195,0.149891493195,0.154344056712,0.208756380157,0.239402891983,0.244881542059,0.248040971963,0.249573797558,0.282188351995,0.282188351995,0.282188351995,0.30677476486,0.31862383956,0.291019026725,0.291019026725,0.299186389964,0.291019026725,0.299186389964,0.299186389964,0.311830592002,0.31862383956,0.31862383956,0.31862383956,0.31862383956)
L_mean=c(0.25012370221, 0.25012370221,0.250851504831,0.250933561039,0.234091588733,0.210309902219,0.111605417277,0.0908986827945,0.0863590985987,0.0836889613462,0.0835880023519,0.0838543219652,0.0840368292628,0.0843575454652,0.0873314061297,0.0880170638863,0.0886332568836,0.0886332568836,0.0886332568836,0.0900714901714,0.111280783771,0.152596327443,0.161082984097,0.16805960743,0.175302911371,0.176445586182,0.178360160666,0.179351308107,0.183595782075,0.210881227251,0.224530058048,0.228692093739,0.234134349536,0.239711161841,0.25094762122,0.250708366739,0.252279321304,0.252721084188,0.251385228905,0.25436925321,0.253804669792,0.253928613568,0.252006044167,0.249518880328,0.250020158139,0.256927648564,0.255010232901,0.25465080135,0.254003503052,0.254003503052)
M_mean=c(1.12020800643, 1.12020800643,0.130162668364,0.130162668364,0.130162668364,0.130162668364,0.127656919187,0.126303163564,0.121759466173,0.107829565127,0.103453593125,0.101566504056,0.0995272097252,0.0990502155866,0.0989377818175,0.0986775252971,0.0984974060936,0.0981440412255,0.0981440412255,0.0981440412255,0.0981440412255,0.0981440412255,0.0981440412255,0.0981440412255,0.0981440412255,0.0981440412255,0.0981440412255,0.0981440412255,0.0981440412255,0.0981440412255,0.0979445250628,0.0979445250628,0.0979445250628,0.0979445250628,0.0979445250628,0.0979445250628,0.0979445250628,0.0983445218066,0.0983445218066,0.0985794940104,0.0992639294957,0.0996219704129,0.0990691462109,0.0993880189138,0.0993880189138,0.0993880189138,0.0993880189138,0.0993880189138,0.0993880189138,0.0993880189138)
R_mean=c(-0.87008430422, -0.87008430422,0.120688836468,0.120770892676,0.103928920369,0.0801472338556,-0.0160515019106,-0.0354044807699,-0.0354003675742,-0.0241406037811,-0.0198655907734,-0.0177121820907,-0.0154903804624,-0.0146926701214,-0.0116063756878,-0.0106604614108,-0.00986414921003,-0.00951078434193,-0.00951078434193,-0.0080725510541,0.013136742546,0.054452286217,0.0629389428711,0.0699155662041,0.0771588701454,0.0783015449561,0.0802161194401,0.0812072668817,0.0854517408499,0.112737186026,0.126585532985,0.130747568676,0.136189824473,0.141766636778,0.153003096157,0.152763841676,0.154334796241,0.154376562382,0.153040707098,0.1557897592,0.154540740296,0.154306643155,0.152936897956,0.150130861414,0.150632139225,0.15753962965,0.155622213988,0.155262782436,0.154615484138,0.154615484138)
trans=0.5
age=(0:(50-1))* -1
plot(age,age,type = 'n', ylim = c(0, 0.454389245089), xlim = c(-52.5,2.5), ylab = 'Speciation rate', xlab = 'Ma',main='canid' )
polygon(c(age, rev(age)), c(L_hpd_M95, rev(L_hpd_m95)), col = alpha("#4c4cec",trans), border = NA)
lines(rev(age), rev(L_mean), col = "#4c4cec", lwd=3)
plot(age,age,type = 'n', ylim = c(0, 1.66425109457), xlim = c(-52.5,2.5), ylab = 'Extinction rate', xlab = 'Ma' )
polygon(c(age, rev(age)), c(M_hpd_M95, rev(M_hpd_m95)), col = alpha("#e34a33",trans), border = NA)
lines(rev(age), rev(M_mean), col = "#e34a33", lwd=3)
plot(age,age,type = 'n', ylim = c(-1.42580275267, 0.350486223516), xlim = c(-52.5,2.5), ylab = 'Net diversification rate', xlab = 'Ma' )
abline(h=0,lty=2,col="darkred")
polygon(c(age, rev(age)), c(R_hpd_M95, rev(R_hpd_m95)), col = alpha("#504A4B",trans), border = NA)
lines(rev(age), rev(R_mean), col = "#504A4B", lwd=3)
plot(age,age,type = 'n', ylim = c(0, max(1/M_mean)), xlim = c(-52.5,2.5), ylab = 'Longevity (Myr)', xlab = 'Ma' )
lines(rev(age), rev(1/M_mean), col = "#504A4B", lwd=3)
n <- dev.off()